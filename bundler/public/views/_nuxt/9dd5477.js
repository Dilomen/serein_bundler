(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1166:function(t,e,n){var map={"./af":876,"./af.js":876,"./ar":877,"./ar-dz":878,"./ar-dz.js":878,"./ar-kw":879,"./ar-kw.js":879,"./ar-ly":880,"./ar-ly.js":880,"./ar-ma":881,"./ar-ma.js":881,"./ar-sa":882,"./ar-sa.js":882,"./ar-tn":883,"./ar-tn.js":883,"./ar.js":877,"./az":884,"./az.js":884,"./be":885,"./be.js":885,"./bg":886,"./bg.js":886,"./bm":887,"./bm.js":887,"./bn":888,"./bn-bd":889,"./bn-bd.js":889,"./bn.js":888,"./bo":890,"./bo.js":890,"./br":891,"./br.js":891,"./bs":892,"./bs.js":892,"./ca":893,"./ca.js":893,"./cs":894,"./cs.js":894,"./cv":895,"./cv.js":895,"./cy":896,"./cy.js":896,"./da":897,"./da.js":897,"./de":898,"./de-at":899,"./de-at.js":899,"./de-ch":900,"./de-ch.js":900,"./de.js":898,"./dv":901,"./dv.js":901,"./el":902,"./el.js":902,"./en-au":903,"./en-au.js":903,"./en-ca":904,"./en-ca.js":904,"./en-gb":905,"./en-gb.js":905,"./en-ie":906,"./en-ie.js":906,"./en-il":907,"./en-il.js":907,"./en-in":908,"./en-in.js":908,"./en-nz":909,"./en-nz.js":909,"./en-sg":910,"./en-sg.js":910,"./eo":911,"./eo.js":911,"./es":912,"./es-do":913,"./es-do.js":913,"./es-mx":914,"./es-mx.js":914,"./es-us":915,"./es-us.js":915,"./es.js":912,"./et":916,"./et.js":916,"./eu":917,"./eu.js":917,"./fa":918,"./fa.js":918,"./fi":919,"./fi.js":919,"./fil":920,"./fil.js":920,"./fo":921,"./fo.js":921,"./fr":922,"./fr-ca":923,"./fr-ca.js":923,"./fr-ch":924,"./fr-ch.js":924,"./fr.js":922,"./fy":925,"./fy.js":925,"./ga":926,"./ga.js":926,"./gd":927,"./gd.js":927,"./gl":928,"./gl.js":928,"./gom-deva":929,"./gom-deva.js":929,"./gom-latn":930,"./gom-latn.js":930,"./gu":931,"./gu.js":931,"./he":932,"./he.js":932,"./hi":933,"./hi.js":933,"./hr":934,"./hr.js":934,"./hu":935,"./hu.js":935,"./hy-am":936,"./hy-am.js":936,"./id":937,"./id.js":937,"./is":938,"./is.js":938,"./it":939,"./it-ch":940,"./it-ch.js":940,"./it.js":939,"./ja":941,"./ja.js":941,"./jv":942,"./jv.js":942,"./ka":943,"./ka.js":943,"./kk":944,"./kk.js":944,"./km":945,"./km.js":945,"./kn":946,"./kn.js":946,"./ko":947,"./ko.js":947,"./ku":948,"./ku.js":948,"./ky":949,"./ky.js":949,"./lb":950,"./lb.js":950,"./lo":951,"./lo.js":951,"./lt":952,"./lt.js":952,"./lv":953,"./lv.js":953,"./me":954,"./me.js":954,"./mi":955,"./mi.js":955,"./mk":956,"./mk.js":956,"./ml":957,"./ml.js":957,"./mn":958,"./mn.js":958,"./mr":959,"./mr.js":959,"./ms":960,"./ms-my":961,"./ms-my.js":961,"./ms.js":960,"./mt":962,"./mt.js":962,"./my":963,"./my.js":963,"./nb":964,"./nb.js":964,"./ne":965,"./ne.js":965,"./nl":966,"./nl-be":967,"./nl-be.js":967,"./nl.js":966,"./nn":968,"./nn.js":968,"./oc-lnc":969,"./oc-lnc.js":969,"./pa-in":970,"./pa-in.js":970,"./pl":971,"./pl.js":971,"./pt":972,"./pt-br":973,"./pt-br.js":973,"./pt.js":972,"./ro":974,"./ro.js":974,"./ru":975,"./ru.js":975,"./sd":976,"./sd.js":976,"./se":977,"./se.js":977,"./si":978,"./si.js":978,"./sk":979,"./sk.js":979,"./sl":980,"./sl.js":980,"./sq":981,"./sq.js":981,"./sr":982,"./sr-cyrl":983,"./sr-cyrl.js":983,"./sr.js":982,"./ss":984,"./ss.js":984,"./sv":985,"./sv.js":985,"./sw":986,"./sw.js":986,"./ta":987,"./ta.js":987,"./te":988,"./te.js":988,"./tet":989,"./tet.js":989,"./tg":990,"./tg.js":990,"./th":991,"./th.js":991,"./tk":992,"./tk.js":992,"./tl-ph":993,"./tl-ph.js":993,"./tlh":994,"./tlh.js":994,"./tr":995,"./tr.js":995,"./tzl":996,"./tzl.js":996,"./tzm":997,"./tzm-latn":998,"./tzm-latn.js":998,"./tzm.js":997,"./ug-cn":999,"./ug-cn.js":999,"./uk":1e3,"./uk.js":1e3,"./ur":1001,"./ur.js":1001,"./uz":1002,"./uz-latn":1003,"./uz-latn.js":1003,"./uz.js":1002,"./vi":1004,"./vi.js":1004,"./x-pseudo":1005,"./x-pseudo.js":1005,"./yo":1006,"./yo.js":1006,"./zh-cn":1007,"./zh-cn.js":1007,"./zh-hk":1008,"./zh-hk.js":1008,"./zh-mo":1009,"./zh-mo.js":1009,"./zh-tw":1010,"./zh-tw.js":1010};function r(t){var e=o(t);return n(e)}function o(t){if(!n.o(map,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return map[t]}r.keys=function(){return Object.keys(map)},r.resolve=o,t.exports=r,r.id=1166},1167:function(t,e,n){"use strict";var r=n(805);n.n(r).a},1168:function(t,e,n){(e=n(89)(!1)).push([t.i,'.page{padding:20px 0;text-align:right}.status-style{position:relative;margin-right:6px}.status-style:after{content:"";position:absolute;top:10px;right:-7px;width:6px;height:1px;background:#dcdee2}',""]),t.exports=e},1175:function(t,e,n){"use strict";n.r(e);n(93),n(119),n(91),n(230),n(231),n(167),n(92),n(120);var r,o=n(141),c=n(228),l=n(861),j=n.n(l),h=n(229);n(732);function m(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var f=(r={props:{},data:function(){return{socket:null,searchForm:{repositoryName:"",branch:"",pusher:"",createTime:[]},current:1,limit:15,total:0,columns:[{title:"项目名",key:"repositoryName"},{title:"分支名",key:"branch"},{title:"提交人",key:"pusher"},{title:"提交时间",key:"createTime"},{title:"提交描述",key:"commitMessage"},{title:"打包时间",slot:"consumeTime"},{title:"状态",slot:"status",width:150},{title:"Action",slot:"action",width:150}],tableData:[],isUpdateSocket:!0}},computed:{},created:function(){},beforeDestroy:function(){this.socket.disconnect()},mounted:function(){this.connectSocket(),this.getData()}},Object(o.a)(r,"computed",{query:function(){return d(d({},this.searchForm),{},{limit:this.limit,offset:this.current})},userInfo:function(){return this.$store.state.userInfo}}),Object(o.a)(r,"methods",{interruptAuth:function(t){return 0===this.userInfo.identity||this.userInfo.username===t},connectSocket:function(){var t=this;this.socket=j()(h.a.BASE_URL,{withCredentials:!1}),this.socket.on("connect",(function(){console.log("connection success")})),this.socket.on("message",(function(e){"UPDATE_LIST_VIEW"===e.type&&1===t.current&&t.isUpdateSocket&&(t.isUpdateSocket=!1,t.getData(),setTimeout((function(){t.isUpdateSocket=!0}),10))}))},handleSubmit:function(t){t||(this.searchForm={}),this.current=1,this.getData()},getData:function(){var t=this;c.a.get(h.a.BUNDLER_LIST,{params:this.query}).then((function(data){t.tableData=data.data||[],t.total=data.total})).catch((function(t){return console.error(t)}))},handleChangeLimit:function(t){this.limit=t,this.getData()},handleChangePage:function(t){this.current=t,this.getData()},handleInterrupt:function(t,e){var n=this,r=t.soloId,o=t.branch,l=t.repositoryName;c.a.put(h.a.BUNDLER_INTERRUPT,{id:r,branch:o,repositoryName:l}).then((function(data){1===data.code?n.tableData[e].buildStatus=7:n.$Message.warning("中断失败")})).catch((function(t){return console.error(t)}))},handleDetail:function(t,e){this.$router.push({path:"detail/"+t})}}),r),y=(n(1167),n(51)),component=Object(y.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Form",{ref:"formInline",attrs:{model:t.searchForm,"label-width":80,inline:""}},[n("FormItem",{attrs:{label:"项目名"}},[n("Input",{staticStyle:{width:"200px"},model:{value:t.searchForm.repositoryName,callback:function(e){t.$set(t.searchForm,"repositoryName",e)},expression:"searchForm.repositoryName"}})],1),t._v(" "),n("FormItem",{attrs:{label:"分支名"}},[n("Input",{staticStyle:{width:"200px"},model:{value:t.searchForm.branch,callback:function(e){t.$set(t.searchForm,"branch",e)},expression:"searchForm.branch"}})],1),t._v(" "),n("FormItem",{attrs:{label:"提交人"}},[n("Input",{staticStyle:{width:"200px"},model:{value:t.searchForm.pusher,callback:function(e){t.$set(t.searchForm,"pusher",e)},expression:"searchForm.pusher"}})],1),t._v(" "),n("FormItem",{attrs:{label:"提交时间"}},[n("DatePicker",{staticStyle:{width:"200px"},attrs:{type:"daterange",placement:"bottom-end"},on:{"on-change":function(e){t.searchForm.createTime=e}},model:{value:t.searchForm.createTime,callback:function(e){t.$set(t.searchForm,"createTime",e)},expression:"searchForm.createTime"}})],1),t._v(" "),n("FormItem",[n("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit(!0)}}},[t._v("查询")]),t._v(" "),n("Button",{on:{click:function(e){return t.handleSubmit(!1)}}},[t._v("重置")])],1)],1),t._v(" "),n("Table",{attrs:{columns:t.columns,data:t.tableData},scopedSlots:t._u([{key:"consumeTime",fn:function(e){var r=e.row;return[r.consumeTime>1e5?n("Tag",{attrs:{color:"volcano"}},[t._v(t._s(((r.consumeTime||0)/1e3).toFixed(2)+"s"))]):n("Tag",{attrs:{color:"blue"}},[t._v(t._s(((r.consumeTime||0)/1e3).toFixed(2)+"s"))])]}},{key:"status",fn:function(e){var r=e.row;return t._l(r.statusShow,(function(t,e){return n("Tooltip",{key:e,attrs:{content:t.label,placement:"top"}},[n("Button",{class:[e<r.statusShow.length-1?"status-style":""],attrs:{type:t.type,shape:"circle",size:"small",icon:t.icon,loading:t.loading}})],1)}))}},{key:"action",fn:function(e){var r=e.row,o=e.index;return[n("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.handleDetail(r.id,r.status)}}},[t._v("详情")]),t._v(" "),t.interruptAuth(r.commitPerson)?n("Poptip",{attrs:{confirm:"",title:"确定中断当前任务吗",transfer:!0,"ok-text":"确定","cancel-text":"取消"},on:{"on-ok":function(e){return t.handleInterrupt(r,o)}}},[[1,2].includes(r.buildStatus)?n("Button",{attrs:{type:"error",size:"small"}},[t._v("中断")]):t._e()],1):t._e()]}}])}),t._v(" "),n("Page",{attrs:{"class-name":"page",total:t.total,"show-total":"","page-size-opts":[10,15,20,30,50,100],current:t.current,size:"small","show-elevator":"","page-size":t.limit,"show-sizer":""},on:{"on-change":t.handleChangePage,"on-page-size-change":t.handleChangeLimit}})],1)}),[],!1,null,null,null);e.default=component.exports},805:function(t,e,n){var content=n(1168);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(90).default)("28f1127f",content,!0,{sourceMap:!1})},870:function(t,e){}}]);