(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{1164:function(t,e,n){"use strict";var o=n(804);n.n(o).a},1165:function(t,e,n){(e=n(89)(!1)).push([t.i,".build-detail-wrap .build-setting[data-v-25eafa06]{display:flex;align-items:center;justify-content:space-between;padding-bottom:20px}.build-detail[data-v-25eafa06]{min-height:calc(100vh - 240px);height:-webkit-max-content;height:-moz-max-content;height:max-content;background:#333;padding:30px;color:#e4e0e0}.build-detail pre[data-v-25eafa06]{white-space:pre-wrap;word-wrap:break-word}",""]),t.exports=e},1174:function(t,e,n){"use strict";n.r(e);n(168),n(120),n(94);var o=n(21),r=n(229),c=n(228),l=n(861),d=n.n(l),h={mounted:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:[1,2].includes(t.detailData.buildStatus)&&t.connectSocket();case 1:case"end":return e.stop()}}),e)})))()},computed:{userInfo:function(){return this.$store.state.userInfo},isShowInterrupt:function(){return[1,2].includes(this.detailData.buildStatus)&&(0===this.userInfo.identity||this.userInfo.username===this.detailData.commitPerson)}},asyncData:function(t){var e=t.params;return c.a.get(r.a.BUNDLER_DETAIL,{params:e}).then((function(data){return{detailData:data}})).catch((function(t){return console.error(t)}))},data:function(){return{id:+this.$route.params.id,socket:null,detailData:{commitContent:""},isUpdateSocket:!0}},beforeDestroy:function(){this.socket&&this.socket.emit("leave",{soloId:this.detailData.soloId}),this.socket&&this.socket.disconnect()},methods:{connectSocket:function(){var t=this;this.socket=d()(r.a.BASE_URL,{withCredentials:!1}),this.socket.emit("join",{soloId:this.detailData.soloId}),this.socket.on("message",(function(e){"UPDATE_DETAIL"===e.type?t.isUpdateSocket&&(t.isUpdateSocket=!1,t.detailData.commitContent=e.data.commitContent,t.detailData.status=e.data.status,setTimeout((function(){t.isUpdateSocket=!0}),500)):"UPDATE_VIEW"===e.type&&(t.socket.disconnect(),c.a.get(r.a.BUNDLER_DETAIL,{params:{id:t.id}}).then((function(data){t.detailData=data})).catch((function(t){return console.error(t)})))}))},handleInterrupt:function(t){var e,n=this,l=t.soloId,d=t.branch,h=t.repositoryName;t.commitPerson;this.$Modal.confirm({title:"确定中断吗",content:"中断后，该项目将停止打包",okText:"确定",cancelText:"取消",onOk:(e=Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.a.put(r.a.BUNDLER_INTERRUPT,{id:l,branch:d,repositoryName:h}).catch((function(t){return console.error(t)}));case 2:1===t.sent.code?setTimeout((function(){n.detailData.statusShow=[{type:"default",label:"打包取消",loading:!1,icon:"md-remove-circle"},{type:"default",label:"打包取消",loading:!1,icon:"md-remove-circle"}],n.detailData.buildStatus=7}),1e3):n.$Message.warning("中断失败");case 5:case"end":return t.stop()}}),t)}))),function(){return e.apply(this,arguments)}),onCancel:function(){}})}}},f=(n(1164),n(51)),component=Object(f.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"build-detail-wrap"},[n("div",{staticClass:"build-setting"},[n("div",[n("h2",[t._v("\n        项目名："+t._s(t.detailData.repositoryName)+"\n        "),t._l(t.detailData.statusShow,(function(e,o){return n("Tooltip",{key:o,attrs:{content:e.label,placement:"top"}},[n("Button",{class:[o<t.detailData.statusShow.length-1?"status-style":""],attrs:{type:e.type,shape:"circle",size:"small",icon:e.icon,loading:e.loading}})],1)}))],2),t._v(" "),n("p",[t._v("分支名："+t._s(t.detailData.branch))])]),t._v(" "),t.isShowInterrupt?n("Button",{attrs:{type:"warning"},on:{click:function(e){return t.handleInterrupt(t.detailData)}}},[t._v("中断")]):t._e()],1),t._v(" "),n("div",{staticClass:"build-detail"},[n("pre",[t._v(t._s(t.detailData.commitContent))])])])}),[],!1,null,"25eafa06",null);e.default=component.exports},804:function(t,e,n){var content=n(1165);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(90).default)("b9578584",content,!0,{sourceMap:!1})},870:function(t,e){}}]);